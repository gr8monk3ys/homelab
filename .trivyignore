# Trivy Ignore File for Homelab
# These rules are either false positives or intentional configuration choices
# See: https://avd.aquasec.com/misconfig/kubernetes/

# =============================================================================
# FALSE POSITIVES - Rules that trigger on non-applicable resources
# =============================================================================

# KSV040: Image tag not pinned
# This triggers false positives on NetworkPolicies, PDBs, HPAs, ServiceMonitors,
# and other resources that don't have container images
KSV040

# AVD-KSV-01010: Similar false positive issues
AVD-KSV-01010

# =============================================================================
# INTENTIONAL CONFIGURATIONS - Standard practices that Trivy flags
# =============================================================================

# KSV0125: Container images from "untrusted" registries
# We use standard, well-known registries:
# - Docker Hub (docker.io)
# - GitHub Container Registry (ghcr.io)
# - LinuxServer.io (lscr.io)
# - Quay.io (quay.io)
# - Google Container Registry (gcr.io)
# These are industry-standard registries, not untrusted
KSV0125

# KSV021: User ID < 10000
# KSV020: Group ID < 10000
# Most container images use standard UIDs:
# - 1000 (typical non-root user)
# - 999 (postgres, redis)
# - 65534 (nobody)
# - 911 (LinuxServer.io)
# Forcing UIDs >10000 would break most applications
KSV021
KSV020

# =============================================================================
# LEGITIMATE SERVICE REQUIREMENTS - Services that need elevated privileges
# =============================================================================

# KSV012: Runs as root
# Some applications legitimately require root:
# - LinuxServer.io images (use internal PUID/PGID for permissions)
# - System monitoring (netdata, promtail)
# - Network services (pihole, dnsmasq, wireguard)
# - Certain init containers
KSV012

# KSV014: SYS_ADMIN capability
# Required for specific services:
# - FlareSolverr (Chromium sandbox)
# - Netdata (system monitoring)
# These are documented and intentional
KSV014

# KSV001: Process can elevate privileges
# Covered by explicit allowPrivilegeEscalation: false in our security contexts
KSV001

# KSV003: Default capabilities not dropped
# We explicitly drop ALL capabilities in our deployments
KSV003

# KSV009: NET_RAW capability
# Required for:
# - MetalLB speaker (ARP announcements)
# - dnsmasq-dhcp (DHCP operations)
KSV009

# =============================================================================
# LOW PRIORITY - Already mitigated or minimal risk
# =============================================================================

# KSV106: Container running without memory limits
# We have resource limits on all main containers; some init containers
# intentionally have relaxed limits as they run briefly
KSV106

# KSV117-121: Various pod security standards
# These are informational for restricted PSS compliance
# Our deployments target baseline PSS with specific exceptions
KSV117
KSV118
KSV119
KSV120
KSV121

# no-user-pods-in-system-namespace: Informational
no-user-pods-in-system-namespace
