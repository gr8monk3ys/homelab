# Trivy Ignore File for Homelab
# These rules are either false positives or intentional configuration choices

# KSV0125: Container images from "untrusted" registries
# We use standard, well-known registries (Docker Hub, ghcr.io, lscr.io, quay.io, gcr.io)
# These are industry-standard registries, not untrusted
KSV0125

# KSV021/KSV020: User/Group ID requirements (>10000)
# Many container images are designed to run as specific users (1000, 911, 65534, etc.)
# Forcing UIDs >10000 would break many applications
KSV021
KSV020

# KSV014: SYS_ADMIN capability
# Some services legitimately require elevated capabilities:
# - Wireguard (VPN requires network admin)
# - PiHole (DNS server)
# - Netdata (system monitoring)
# Individual services with this need have documented justification
# Ignore globally but review individual deployments

# KSV012: Runs as root
# Some applications require root:
# - System monitoring tools (Netdata, Promtail)
# - Network tools (Wireguard, DNSMasq)
# - LinuxServer.io images (manage permissions internally)
# Review case-by-case rather than blanket reject

# KSV001: Process can elevate privileges
# Covered by our explicit allowPrivilegeEscalation: false in security contexts

# KSV003: Default capabilities not dropped
# We explicitly drop ALL capabilities in our deployments

# Non-actionable alerts
no-user-pods-in-system-namespace
